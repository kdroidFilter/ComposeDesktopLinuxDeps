# Compose Desktop Linux Package Deps (DEB)

Small Gradle plugin for **Compose Desktop** that automatically adds Debian **`Depends:`** to the `.deb` generated by **jpackage**.
Can write `StartupWMClass` into `.desktop` files to fix dock/taskbar icons (fixes JBR-9114: https://youtrack.jetbrains.com/issue/JBR-9114).

## Plugin

* **ID:** `io.github.kdroidfilter.compose.linux.packagedeps`
* **Version:** `0.1.0`

## Requirements

* Debian/Ubuntu build env with `dpkg-deb` (`sudo apt-get install dpkg-dev`)
* Using Compose Multiplatform packaging (`packageDeb` / `packageReleaseDeb`)

## Quick start

```kotlin
// build.gradle.kts
plugins {
    id("io.github.kdroidfilter.compose.linux.packagedeps") version "0.1.0"
}

linuxDebConfig {
    debDepends.set(listOf("libqt5widgets5t64", "libx11-6"))
    // Optional: fix dock icon matching
    startupWMClass.set("MainClassKt")
}
```

Build as usual:

```bash
./gradlew packageDeb
# or
./gradlew packageReleaseDeb
```

## What it does

* Finds the jpackage-generated `.deb`
* Adds/merges a `Depends:` line in `DEBIAN/control` (de-duplicates)
* Writes `StartupWMClass=` into `.desktop` files if configured
* Rebuilds the `.deb`

## Troubleshooting

* **`dpkg-deb not found`** → `sudo apt-get install dpkg-dev`
* **No `.deb` found** → run `./gradlew packageDeb` first
* **Dock icon not matching** → set `startupWMClass` (e.g., `"MainClassKt"`)

## License

MIT — see `LICENSE`.
